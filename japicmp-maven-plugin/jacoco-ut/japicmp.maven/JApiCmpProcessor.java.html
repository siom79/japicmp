<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JApiCmpProcessor.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">japicmp-maven-plugin</a> &gt; <a href="index.source.html" class="el_package">japicmp.maven</a> &gt; <span class="el_source">JApiCmpProcessor.java</span></div><h1>JApiCmpProcessor.java</h1><pre class="source lang-java linenums">package japicmp.maven;

import com.google.common.base.Joiner;
import japicmp.cli.JApiCli;
import japicmp.cmp.JApiCmpArchive;
import japicmp.cmp.JarArchiveComparator;
import japicmp.cmp.JarArchiveComparatorOptions;
import japicmp.config.Options;
import japicmp.exception.JApiCmpException;
import japicmp.model.AccessModifier;
import japicmp.model.JApiClass;
import japicmp.model.JApiCompatibilityChangeType;
import japicmp.model.JApiSemanticVersionLevel;
import japicmp.output.html.HtmlOutput;
import japicmp.output.html.HtmlOutputGenerator;
import japicmp.output.html.HtmlOutputGeneratorOptions;
import japicmp.output.incompatible.IncompatibleErrorOutput;
import japicmp.output.markdown.MarkdownOutputGenerator;
import japicmp.output.markdown.config.MarkdownOptions;
import japicmp.output.semver.SemverOut;
import japicmp.output.stdout.StdoutOutputGenerator;
import japicmp.output.xml.XmlOutput;
import japicmp.output.xml.XmlOutputGenerator;
import japicmp.output.xml.XmlOutputGeneratorOptions;
import japicmp.util.FileHelper;
import japicmp.versioning.SemanticVersion;
import org.apache.maven.RepositoryUtils;
import org.apache.maven.plugin.MojoExecutionException;
import org.apache.maven.plugin.MojoFailureException;
import org.apache.maven.plugin.logging.Log;
import org.apache.maven.project.MavenProject;
import org.eclipse.aether.artifact.Artifact;
import org.eclipse.aether.artifact.DefaultArtifact;
import org.eclipse.aether.resolution.*;

import java.io.File;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.*;
import java.util.jar.JarFile;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.regex.PatternSyntaxException;

public class JApiCmpProcessor {

	final MavenParameters mavenParameters;
	final PluginParameters pluginParameters;
	final Log log;

	private Options options;

	public JApiCmpProcessor(final PluginParameters pluginParameters,
							final MavenParameters mavenParameters,
<span class="fc" id="L59">							final Log log) {</span>
<span class="fc" id="L60">		this.pluginParameters = pluginParameters;</span>
<span class="fc" id="L61">		this.mavenParameters = mavenParameters;</span>
<span class="fc" id="L62">		this.log = log;</span>
<span class="fc" id="L63">	}</span>

	public Optional&lt;HtmlOutput&gt; execute() throws MojoExecutionException, MojoFailureException {
<span class="fc bfc" id="L66" title="All 2 branches covered.">		if (pluginParameters.skip()) {</span>
<span class="fc" id="L67">			log.info(&quot;japicmp skipped.&quot;);</span>
<span class="fc" id="L68">			return Optional.empty();</span>
		}
<span class="fc bfc" id="L70" title="All 2 branches covered.">		if (skipModule()) {</span>
<span class="fc" id="L71">			return Optional.empty();</span>
		}
<span class="fc" id="L73">		Options options = getOptions();</span>
<span class="fc" id="L74">		JarArchiveComparatorOptions comparatorOptions = JarArchiveComparatorOptions.of(options);</span>
<span class="fc" id="L75">		setUpClassPath(comparatorOptions);</span>
<span class="fc" id="L76">		setUpOverrideCompatibilityChanges(comparatorOptions);</span>
<span class="fc" id="L77">		JarArchiveComparator jarArchiveComparator = new JarArchiveComparator(comparatorOptions);</span>
<span class="fc bfc" id="L78" title="All 2 branches covered.">		if (options.getNewArchives().isEmpty()) {</span>
<span class="fc" id="L79">			log.warn(&quot;Skipping execution because no new version could be resolved/found.&quot;);</span>
<span class="fc" id="L80">			return Optional.empty();</span>
		}

<span class="fc" id="L83">		List&lt;JApiClass&gt; jApiClasses = jarArchiveComparator.compare(options.getOldArchives(),</span>
<span class="fc" id="L84">				options.getNewArchives());</span>
		try {
<span class="fc" id="L86">			PostAnalysisScriptExecutor postAnalysisScriptExecutor = new PostAnalysisScriptExecutor();</span>
<span class="fc" id="L87">			postAnalysisScriptExecutor.apply(pluginParameters.parameter(), jApiClasses, log);</span>
<span class="fc" id="L88">			File jApiCmpBuildDir = createJApiCmpBaseDir();</span>
<span class="fc" id="L89">			SemverOut semverOut = new SemverOut(options, jApiClasses);</span>
<span class="fc" id="L90">			String semanticVersioningInformation = semverOut.generate();</span>
<span class="fc bfc" id="L91" title="All 2 branches covered.">			if (!skipDiffReport()) {</span>
<span class="fc" id="L92">				generateDiffOutput(options, jApiClasses, jApiCmpBuildDir, semanticVersioningInformation);</span>
			}
<span class="fc bfc" id="L94" title="All 2 branches covered.">			if (!skipMarkdownReport()) {</span>
<span class="fc" id="L95">				generateMarkdownOutput(jApiClasses, jApiCmpBuildDir);</span>
			}
<span class="fc bfc" id="L97" title="All 2 branches covered.">			if (!skipXmlReport()) {</span>
<span class="fc" id="L98">				generateXmlOutput(jApiClasses, jApiCmpBuildDir, semanticVersioningInformation);</span>
			}
<span class="fc" id="L100">			Optional&lt;HtmlOutput&gt; retVal = Optional.empty();</span>
<span class="fc bfc" id="L101" title="All 2 branches covered.">			if (!skipHtmlReport()) {</span>
<span class="fc" id="L102">				retVal = Optional.of(generateHtmlOutput(jApiClasses, jApiCmpBuildDir,</span>
						semanticVersioningInformation));
			}
<span class="fc" id="L105">			breakBuildIfNecessary(jApiClasses, pluginParameters.parameter(), options,</span>
					jarArchiveComparator);
<span class="fc" id="L107">			return retVal;</span>
<span class="nc" id="L108">		} catch (IOException e) {</span>
<span class="nc" id="L109">			throw new MojoFailureException(</span>
<span class="nc" id="L110">					String.format(&quot;Failed to construct output directory: %s&quot;, e.getMessage()), e);</span>
		}
	}

	private void setUpOverrideCompatibilityChanges(
			final JarArchiveComparatorOptions comparatorOptions)
			throws MojoFailureException {
<span class="pc bpc" id="L117" title="1 of 2 branches missed.">		if (pluginParameters.parameter().getOverrideCompatibilityChangeParameters() != null) {</span>
<span class="nc" id="L118">			final List&lt;ConfigParameters.OverrideCompatibilityChangeParameter&gt; overrideCompatibilityChangeParameters =</span>
<span class="nc" id="L119">					pluginParameters.parameter().getOverrideCompatibilityChangeParameters();</span>
<span class="nc bnc" id="L120" title="All 2 branches missed.">			for (final ConfigParameters.OverrideCompatibilityChangeParameter configChange : overrideCompatibilityChangeParameters) {</span>
<span class="nc" id="L121">				final String compatibilityChange = configChange.getCompatibilityChange();</span>
<span class="nc" id="L122">				JApiCompatibilityChangeType foundChange = null;</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">				for (JApiCompatibilityChangeType change : JApiCompatibilityChangeType.values()) {</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">					if (change.name().equalsIgnoreCase(compatibilityChange)) {</span>
<span class="nc" id="L125">						foundChange = change;</span>
<span class="nc" id="L126">						break;</span>
					}
				}
<span class="nc bnc" id="L129" title="All 2 branches missed.">				if (foundChange == null) {</span>
<span class="nc" id="L130">					throw new MojoFailureException(&quot;Unknown compatibility change '&quot;</span>
							+ compatibilityChange
							+ &quot;'. Supported values: &quot;
<span class="nc" id="L133">							+ Joiner.on(',')</span>
<span class="nc" id="L134">							.join(JApiCompatibilityChangeType.values()));</span>
				}
<span class="nc" id="L136">				final String semanticVersionLevel = configChange.getSemanticVersionLevel();</span>
<span class="nc" id="L137">				JApiSemanticVersionLevel foundSemanticVersionLevel = foundChange.getSemanticVersionLevel();</span>
<span class="nc bnc" id="L138" title="All 2 branches missed.">				for (final JApiSemanticVersionLevel level : JApiSemanticVersionLevel.values()) {</span>
<span class="nc bnc" id="L139" title="All 2 branches missed.">					if (level.name().equalsIgnoreCase(semanticVersionLevel)) {</span>
<span class="nc" id="L140">						foundSemanticVersionLevel = level;</span>
<span class="nc" id="L141">						break;</span>
					}
				}
<span class="nc bnc" id="L144" title="All 2 branches missed.">				if (foundSemanticVersionLevel == null) {</span>
<span class="nc" id="L145">					throw new MojoFailureException(&quot;Unknown semantic version level '&quot;</span>
							+ semanticVersionLevel
							+ &quot;'. Supported values: &quot;
<span class="nc" id="L148">							+ Joiner.on(',').join(</span>
<span class="nc" id="L149">							JApiSemanticVersionLevel.values()));</span>
				}
<span class="nc" id="L151">				comparatorOptions.addOverrideCompatibilityChange(</span>
						new JarArchiveComparatorOptions.OverrideCompatibilityChange(foundChange,
<span class="nc" id="L153">								configChange.isBinaryCompatible(),</span>
<span class="nc" id="L154">								configChange.isSourceCompatible(),</span>
								foundSemanticVersionLevel));
<span class="nc" id="L156">			}</span>
		}
<span class="fc" id="L158">	}</span>

<span class="fc" id="L160">	enum ConfigurationVersion {</span>
<span class="fc" id="L161">		OLD, NEW</span>
	}

	private DefaultArtifact createDefaultArtifact(final MavenProject mavenProject,
												  final String version) {
<span class="fc" id="L166">		final org.apache.maven.artifact.Artifact artifact = mavenProject.getArtifact();</span>
<span class="fc" id="L167">		return createDefaultArtifact(artifact.getGroupId(), artifact.getArtifactId(),</span>
<span class="fc" id="L168">				artifact.getClassifier(), artifact.getType(), version);</span>
	}

	private DefaultArtifact createDefaultArtifact(final String groupId,
												  final String artifactId,
												  final String classifier,
												  final String type,
												  final String version) {
<span class="fc" id="L176">		String mappedType = type;</span>
<span class="pc bpc" id="L177" title="2 of 4 branches missed.">		if (&quot;bundle&quot;.equals(type) || &quot;ejb&quot;.equals(type)) {</span>
<span class="nc" id="L178">			mappedType = &quot;jar&quot;;</span>
		}
<span class="fc" id="L180">		return new DefaultArtifact(groupId, artifactId, classifier, mappedType, version);</span>
	}

	private Artifact getComparisonArtifact()
			throws MojoFailureException, MojoExecutionException {
<span class="fc" id="L185">		final MavenProject mavenProject = mavenParameters.mavenProject();</span>
		// create a version range of the form (,&lt;current-version-of-the-project&gt;), that includes all
		// versions up to this version
<span class="fc" id="L188">		final DefaultArtifact artifactVersionRange = createDefaultArtifact(mavenProject,</span>
<span class="fc" id="L189">				mavenParameters.versionRangeWithProjectVersion());</span>
<span class="fc" id="L190">		final VersionRangeRequest versionRangeRequest = new VersionRangeRequest(artifactVersionRange,</span>
<span class="fc" id="L191">				mavenParameters.remoteRepos(),</span>
				null);
		try {
<span class="fc" id="L194">			log.debug(&quot;Trying version range: &quot; + versionRangeRequest);</span>
<span class="fc" id="L195">			final VersionRangeResult versionRangeResult = mavenParameters.repoSystem().resolveVersionRange(</span>
<span class="fc" id="L196">					mavenParameters.repoSession(), versionRangeRequest);</span>
<span class="fc" id="L197">			log.debug(&quot;Version range result: &quot; + versionRangeRequest);</span>
<span class="fc" id="L198">			final List&lt;org.eclipse.aether.version.Version&gt; versions = versionRangeResult.getVersions();</span>
<span class="fc" id="L199">			filterSnapshots(versions);</span>
<span class="fc" id="L200">			filterVersionPattern(versions);</span>
<span class="fc" id="L201">			log.debug(&quot;Version range after filtering: &quot; + versions);</span>
<span class="fc bfc" id="L202" title="All 2 branches covered.">			if (!versions.isEmpty()) {</span>
<span class="fc" id="L203">				final DefaultArtifact artifactVersion = createDefaultArtifact(mavenProject,</span>
<span class="fc" id="L204">						versions.get(versions.size() - 1)</span>
<span class="fc" id="L205">								.toString());</span>
<span class="fc" id="L206">				final ArtifactRequest artifactRequest = new ArtifactRequest(artifactVersion,</span>
<span class="fc" id="L207">						mavenParameters.remoteRepos(), null);</span>
<span class="fc" id="L208">				final ArtifactResult artifactResult = mavenParameters.repoSystem().resolveArtifact(</span>
<span class="fc" id="L209">						mavenParameters.repoSession(), artifactRequest);</span>
<span class="fc" id="L210">				processArtifactResult(artifactVersion, artifactResult);</span>
<span class="fc" id="L211">				return artifactResult.getArtifact();</span>
			} else {
<span class="pc bpc" id="L213" title="1 of 2 branches missed.">				if (ignoreMissingOldVersion(ConfigurationVersion.OLD)) {</span>
<span class="nc" id="L214">					log.warn(&quot;Ignoring missing old artifact version: &quot;</span>
<span class="nc" id="L215">							+ artifactVersionRange.getGroupId()</span>
							+ &quot;:&quot;
<span class="nc" id="L217">							+ artifactVersionRange.getArtifactId());</span>
<span class="nc" id="L218">					return null;</span>
				} else {
<span class="fc" id="L220">					throw new MojoFailureException(&quot;Could not find previous version for artifact: &quot;</span>
<span class="fc" id="L221">							+ artifactVersionRange.getGroupId()</span>
							+ &quot;:&quot;
<span class="fc" id="L223">							+ artifactVersionRange.getArtifactId());</span>
				}
			}
<span class="nc" id="L226">		} catch (final VersionRangeResolutionException | ArtifactResolutionException e) {</span>
<span class="nc" id="L227">			log.error(&quot;Failed to retrieve comparison artifact: &quot; + e.getMessage(), e);</span>
<span class="nc" id="L228">			throw new MojoFailureException(e.getMessage(), e);</span>
		}
	}

	private void processArtifactResult(final DefaultArtifact artifactVersion,
									   final ArtifactResult artifactResult)
			throws MojoFailureException {
<span class="pc bpc" id="L235" title="2 of 4 branches missed.">		if (artifactResult.getExceptions() != null &amp;&amp; !artifactResult.getExceptions().isEmpty()) {</span>
<span class="nc" id="L236">			final List&lt;Exception&gt; exceptions = artifactResult.getExceptions();</span>
<span class="nc bnc" id="L237" title="All 2 branches missed.">			for (Exception exception : exceptions) {</span>
<span class="nc" id="L238">				log.debug(exception.getMessage(), exception);</span>
<span class="nc" id="L239">			}</span>
		}
<span class="pc bpc" id="L241" title="1 of 2 branches missed.">		if (artifactResult.isMissing()) {</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">			if (ignoreMissingArtifact(ConfigurationVersion.OLD)) {</span>
<span class="nc" id="L243">				log.warn(&quot;Ignoring missing artifact: &quot; + artifactResult.getArtifact());</span>
			} else {
<span class="nc" id="L245">				throw new MojoFailureException(&quot;Could not resolve artifact: &quot; + artifactVersion);</span>
			}
		}
<span class="fc" id="L248">	}</span>

	private void filterVersionPattern(
			final List&lt;org.eclipse.aether.version.Version&gt; availableVersions)
			throws MojoFailureException {
<span class="pc bpc" id="L253" title="1 of 2 branches missed.">		if (pluginParameters.parameter().getOldVersionPattern() != null) {</span>
<span class="nc" id="L254">			final String versionPattern = pluginParameters.parameter().getOldVersionPattern();</span>
			Pattern pattern;
			try {
<span class="nc" id="L257">				pattern = Pattern.compile(versionPattern);</span>
<span class="nc" id="L258">			} catch (PatternSyntaxException e) {</span>
<span class="nc" id="L259">				throw new MojoFailureException(&quot;Could not compile provided versionPattern '&quot;</span>
						+ versionPattern
						+ &quot;' as regular expression: &quot;
<span class="nc" id="L262">						+ e.getMessage(), e);</span>
<span class="nc" id="L263">			}</span>
<span class="nc" id="L264">			for (final Iterator&lt;org.eclipse.aether.version.Version&gt; versionIterator =</span>
<span class="nc bnc" id="L265" title="All 2 branches missed.">				 availableVersions.iterator(); versionIterator.hasNext(); ) {</span>
<span class="nc" id="L266">				final org.eclipse.aether.version.Version version = versionIterator.next();</span>
<span class="nc" id="L267">				final Matcher matcher = pattern.matcher(version.toString());</span>
<span class="nc bnc" id="L268" title="All 2 branches missed.">				if (!matcher.matches()) {</span>
<span class="nc" id="L269">					versionIterator.remove();</span>
<span class="nc" id="L270">					log.debug(&quot;Filtering version '&quot;</span>
							+ version
							+ &quot;' because it does not match configured versionPattern '&quot;
							+ versionPattern
							+ &quot;'.&quot;);
				}
<span class="nc" id="L276">			}</span>
<span class="nc" id="L277">		} else {</span>
<span class="fc" id="L278">			log.debug(&quot;Parameter &lt;oldVersionPattern&gt; not configured, i.e. no version filtered.&quot;);</span>
		}
<span class="fc" id="L280">	}</span>

	private void filterSnapshots(final List&lt;org.eclipse.aether.version.Version&gt; versions) {
<span class="pc bpc" id="L283" title="1 of 2 branches missed.">		if (!pluginParameters.parameter().isIncludeSnapshots()) {</span>
<span class="fc" id="L284">			versions.removeIf(</span>
<span class="pc bpc" id="L285" title="2 of 4 branches missed.">					version -&gt; version.toString() != null &amp;&amp; version.toString().endsWith(&quot;SNAPSHOT&quot;));</span>
		}
<span class="fc" id="L287">	}</span>

	private void populateArchivesListsFromParameters(final List&lt;JApiCmpArchive&gt; oldArchives,
													 final List&lt;JApiCmpArchive&gt; newArchives)
			throws MojoFailureException {
<span class="fc bfc" id="L292" title="All 2 branches covered.">		if (pluginParameters.oldVersion() != null) {</span>
<span class="fc" id="L293">			oldArchives.addAll(retrieveFileFromConfiguration(pluginParameters.oldVersion(), &quot;oldVersion&quot;,</span>
					ConfigurationVersion.OLD));
		}
<span class="pc bpc" id="L296" title="1 of 2 branches missed.">		if (pluginParameters.oldVersions() != null) {</span>
<span class="nc bnc" id="L297" title="All 2 branches missed.">			for (final DependencyDescriptor dependencyDescriptor : pluginParameters.oldVersions()) {</span>
<span class="nc bnc" id="L298" title="All 2 branches missed.">				if (dependencyDescriptor != null) {</span>
<span class="nc" id="L299">					oldArchives.addAll(retrieveFileFromConfiguration(dependencyDescriptor, &quot;oldVersions&quot;,</span>
							ConfigurationVersion.OLD));
				}
<span class="nc" id="L302">			}</span>
		}
<span class="pc bpc" id="L304" title="1 of 4 branches missed.">		if (pluginParameters.oldVersion() == null &amp;&amp; pluginParameters.oldVersions() == null) {</span>
			try {
<span class="fc" id="L306">				final Artifact comparisonArtifact = getComparisonArtifact();</span>
<span class="pc bpc" id="L307" title="2 of 4 branches missed.">				if (comparisonArtifact != null &amp;&amp; comparisonArtifact.getVersion() != null) {</span>
<span class="fc" id="L308">					Set&lt;Artifact&gt; artifacts = resolveArtifact(comparisonArtifact, ConfigurationVersion.OLD);</span>
<span class="fc bfc" id="L309" title="All 2 branches covered.">					for (Artifact artifact : artifacts) {</span>
<span class="fc" id="L310">						final File file = artifact.getFile();</span>
<span class="pc bpc" id="L311" title="1 of 2 branches missed.">						if (file != null) {</span>
<span class="fc" id="L312">							oldArchives.add(new JApiCmpArchive(file, FileHelper.guessVersion(file)));</span>
						} else {
<span class="nc" id="L314">							handleMissingArtifactFile(artifact);</span>
						}
<span class="fc" id="L316">					}</span>
				}
<span class="nc" id="L318">			} catch (MojoExecutionException e) {</span>
<span class="nc" id="L319">				throw new MojoFailureException(</span>
<span class="nc" id="L320">						&quot;Computing and resolving comparison artifact failed: &quot; + e.getMessage(), e);</span>
<span class="fc" id="L321">			}</span>
		}
<span class="pc bpc" id="L323" title="1 of 2 branches missed.">		if (pluginParameters.newVersion() != null) {</span>
<span class="nc" id="L324">			newArchives.addAll(retrieveFileFromConfiguration(pluginParameters.newVersion(), &quot;newVersion&quot;,</span>
					ConfigurationVersion.NEW));
		}
<span class="pc bpc" id="L327" title="1 of 2 branches missed.">		if (pluginParameters.newVersions() != null) {</span>
<span class="nc bnc" id="L328" title="All 2 branches missed.">			for (final DependencyDescriptor dependencyDescriptor : pluginParameters.newVersions()) {</span>
<span class="nc bnc" id="L329" title="All 2 branches missed.">				if (dependencyDescriptor != null) {</span>
<span class="nc" id="L330">					newArchives.addAll(retrieveFileFromConfiguration(dependencyDescriptor, &quot;newVersions&quot;,</span>
							ConfigurationVersion.NEW));
				}
<span class="nc" id="L333">			}</span>
		}
<span class="pc bpc" id="L335" title="2 of 4 branches missed.">		if (pluginParameters.newVersion() == null &amp;&amp; pluginParameters.newVersions() == null) {</span>
<span class="fc" id="L336">			final MavenProject mavenProject = mavenParameters.mavenProject();</span>
<span class="pc bpc" id="L337" title="2 of 4 branches missed.">			if (mavenProject != null &amp;&amp; mavenProject.getArtifact() != null) {</span>
<span class="fc" id="L338">				final DefaultArtifact defaultArtifact = createDefaultArtifact(mavenProject,</span>
<span class="fc" id="L339">						mavenProject.getVersion());</span>
<span class="fc" id="L340">				final Set&lt;Artifact&gt; artifacts = resolveArtifact(defaultArtifact, ConfigurationVersion.NEW);</span>
<span class="fc bfc" id="L341" title="All 2 branches covered.">				for (Artifact artifact : artifacts) {</span>
<span class="fc" id="L342">					final File file = artifact.getFile();</span>
<span class="pc bpc" id="L343" title="1 of 2 branches missed.">					if (file != null) {</span>
<span class="fc" id="L344">						try (JarFile jarFile = new JarFile(file)) {</span>
<span class="fc" id="L345">							log.debug(&quot;Could open file '&quot;</span>
<span class="fc" id="L346">									+ file.getAbsolutePath()</span>
									+ &quot;' of artifact as jar archive: &quot;
<span class="fc" id="L348">									+ jarFile.getName());</span>
<span class="fc" id="L349">							newArchives.add(new JApiCmpArchive(file, FileHelper.guessVersion(file)));</span>
<span class="nc" id="L350">						} catch (IOException e) {</span>
<span class="nc" id="L351">							log.warn(&quot;No new version specified and file '&quot;</span>
<span class="nc" id="L352">									+ file.getAbsolutePath()</span>
									+ &quot;' of artifact could not be opened as jar archive: &quot;
<span class="nc" id="L354">									+ e.getMessage(), e);</span>
<span class="pc" id="L355">						}</span>
					} else {
<span class="nc" id="L357">						log.warn(&quot;Artifact &quot;</span>
								+ artifact
								+ &quot; does not have a file. Cannot resolve artifact automatically.&quot;);
					}
<span class="fc" id="L361">				}</span>
			}
		}
<span class="fc bfc" id="L364" title="All 2 branches covered.">		if (oldArchives.isEmpty()) {</span>
<span class="fc" id="L365">			String message =</span>
					&quot;Please provide at least one resolvable old version using one of the configuration &quot;
							+ &quot;elements &lt;oldVersion/&gt; or &lt;oldVersions/&gt;.&quot;;
<span class="pc bpc" id="L368" title="1 of 2 branches missed.">			if (ignoreMissingArtifact(ConfigurationVersion.OLD)) {</span>
<span class="fc" id="L369">				log.warn(message);</span>
			} else {
<span class="nc" id="L371">				throw new MojoFailureException(message);</span>
			}
		}
<span class="fc bfc" id="L374" title="All 2 branches covered.">		if (newArchives.isEmpty()) {</span>
<span class="fc" id="L375">			String message =</span>
					&quot;Please provide at least one resolvable new version using one of the configuration &quot;
							+ &quot;elements &lt;newVersion/&gt; or &lt;newVersions/&gt;.&quot;;
<span class="pc bpc" id="L378" title="1 of 2 branches missed.">			if (ignoreMissingArtifact(ConfigurationVersion.NEW)) {</span>
<span class="fc" id="L379">				log.warn(message);</span>
			} else {
<span class="nc" id="L381">				throw new MojoFailureException(message);</span>
			}
		}
<span class="fc" id="L384">	}</span>

	void breakBuildIfNecessary(final List&lt;JApiClass&gt; jApiClasses,
							   final ConfigParameters parameterParam,
							   final Options options,
							   final JarArchiveComparator jarArchiveComparator)
			throws MojoFailureException, MojoExecutionException {
<span class="pc bpc" id="L391" title="1 of 2 branches missed.">		if (breakBuildBasedOnSemanticVersioning(parameterParam)) {</span>
<span class="nc" id="L392">			options.setErrorOnSemanticIncompatibility(true);</span>
		}
<span class="pc bpc" id="L394" title="1 of 2 branches missed.">		if (breakBuildBasedOnSemanticVersioningForMajorVersionZero(parameterParam)) {</span>
<span class="nc" id="L395">			options.setErrorOnSemanticIncompatibilityForMajorVersionZero(true);</span>
		}
<span class="fc bfc" id="L397" title="All 2 branches covered.">		if (breakBuildOnBinaryIncompatibleModifications(parameterParam)) {</span>
<span class="fc" id="L398">			options.setErrorOnBinaryIncompatibility(true);</span>
		}
<span class="fc bfc" id="L400" title="All 2 branches covered.">		if (breakBuildOnSourceIncompatibleModifications(parameterParam)) {</span>
<span class="fc" id="L401">			options.setErrorOnSourceIncompatibility(true);</span>
		}
<span class="fc bfc" id="L403" title="All 2 branches covered.">		if (breakBuildOnModifications(parameterParam)) {</span>
<span class="fc" id="L404">			options.setErrorOnModifications(true);</span>
		}
<span class="fc bfc" id="L406" title="All 2 branches covered.">		if (!parameterParam.isBreakBuildIfCausedByExclusion()) {</span>
<span class="fc" id="L407">			options.setErrorOnExclusionIncompatibility(false);</span>
		}
<span class="fc bfc" id="L409" title="All 2 branches covered.">		if (pluginParameters.parameter().getIgnoreMissingOldVersion()) {</span>
<span class="fc" id="L410">			options.setIgnoreMissingOldVersion(true);</span>
		}
<span class="pc bpc" id="L412" title="1 of 2 branches missed.">		if (pluginParameters.parameter().getIgnoreMissingNewVersion()) {</span>
<span class="nc" id="L413">			options.setIgnoreMissingNewVersion(true);</span>
		}
<span class="fc" id="L415">		IncompatibleErrorOutput errorOutput = new IncompatibleErrorOutput(options, jApiClasses,</span>
<span class="fc" id="L416">				jarArchiveComparator) {</span>
			@Override
			protected void warn(String msg, Throwable error) {
<span class="fc" id="L419">				log.warn(msg, error);</span>
<span class="fc" id="L420">			}</span>
		};
		try {
<span class="fc" id="L423">			errorOutput.generate();</span>
<span class="fc" id="L424">		} catch (JApiCmpException e) {</span>
<span class="pc bpc" id="L425" title="1 of 2 branches missed.">			if (e.getReason() == JApiCmpException.Reason.IncompatibleChange) {</span>
<span class="fc" id="L426">				throw new MojoFailureException(e.getMessage());</span>
			} else {
<span class="nc" id="L428">				throw new MojoExecutionException(&quot;Error while checking for incompatible changes&quot;, e);</span>
			}
<span class="fc" id="L430">		}</span>
<span class="fc" id="L431">	}</span>

	Options getOptions() throws MojoFailureException {
<span class="pc bpc" id="L434" title="1 of 2 branches missed.">		if (this.options != null) {</span>
<span class="nc" id="L435">			return this.options;</span>
		}
<span class="fc" id="L437">		this.options = Options.newDefault();</span>
<span class="fc" id="L438">		populateArchivesListsFromParameters(this.options.getOldArchives(),</span>
<span class="fc" id="L439">				this.options.getNewArchives());</span>
<span class="fc" id="L440">		ConfigParameters parameterParam = pluginParameters.parameter();</span>
<span class="pc bpc" id="L441" title="1 of 2 branches missed.">		if (parameterParam != null) {</span>
<span class="fc" id="L442">			String accessModifierArg = parameterParam.getAccessModifier();</span>
<span class="pc bpc" id="L443" title="1 of 2 branches missed.">			if (accessModifierArg != null) {</span>
				try {
<span class="nc" id="L445">					AccessModifier accessModifier = AccessModifier.valueOf(accessModifierArg.toUpperCase());</span>
<span class="nc" id="L446">					this.options.setAccessModifier(accessModifier);</span>
<span class="nc" id="L447">				} catch (IllegalArgumentException e) {</span>
<span class="nc" id="L448">					throw new MojoFailureException(</span>
<span class="nc" id="L449">							String.format(</span>
									&quot;Invalid value for option accessModifier: %s. Possible values are: %s.&quot;,
<span class="nc" id="L451">									accessModifierArg, AccessModifier.listOfAccessModifier()), e);</span>
<span class="nc" id="L452">				}</span>
			}
<span class="fc" id="L454">			this.options.setOutputOnlyBinaryIncompatibleModifications(</span>
<span class="fc" id="L455">					parameterParam.getOnlyBinaryIncompatible());</span>
<span class="fc" id="L456">			this.options.setOutputOnlyModifications(parameterParam.getOnlyModified());</span>
<span class="fc" id="L457">			List&lt;String&gt; excludes = parameterParam.getExcludes();</span>
<span class="pc bpc" id="L458" title="1 of 2 branches missed.">			if (excludes != null) {</span>
<span class="nc bnc" id="L459" title="All 2 branches missed.">				for (String exclude : excludes) {</span>
<span class="nc" id="L460">					this.options.addExcludeFromArgument(Optional.ofNullable(exclude),</span>
<span class="nc" id="L461">							parameterParam.isExcludeExclusively());</span>
<span class="nc" id="L462">				}</span>
			}
<span class="fc" id="L464">			List&lt;String&gt; includes = parameterParam.getIncludes();</span>
<span class="pc bpc" id="L465" title="1 of 2 branches missed.">			if (includes != null) {</span>
<span class="nc bnc" id="L466" title="All 2 branches missed.">				for (String include : includes) {</span>
<span class="nc" id="L467">					this.options.addIncludeFromArgument(Optional.ofNullable(include),</span>
<span class="nc" id="L468">							parameterParam.isIncludeExlusively());</span>
<span class="nc" id="L469">				}</span>
			}
<span class="fc" id="L471">			this.options.setIncludeSynthetic(parameterParam.getIncludeSynthetic());</span>
<span class="fc" id="L472">			this.options.setIgnoreMissingClasses(parameterParam.getIgnoreMissingClasses());</span>
<span class="fc" id="L473">			List&lt;String&gt; ignoreMissingClassesByRegularExpressions =</span>
<span class="fc" id="L474">					parameterParam.getIgnoreMissingClassesByRegularExpressions();</span>
<span class="pc bpc" id="L475" title="1 of 2 branches missed.">			if (ignoreMissingClassesByRegularExpressions != null) {</span>
				for (String ignoreMissingClassRegularExpression :
<span class="nc bnc" id="L477" title="All 2 branches missed.">						ignoreMissingClassesByRegularExpressions) {</span>
<span class="nc" id="L478">					this.options.addIgnoreMissingClassRegularExpression(ignoreMissingClassRegularExpression);</span>
<span class="nc" id="L479">				}</span>
			}
<span class="fc" id="L481">			String htmlStylesheet = parameterParam.getHtmlStylesheet();</span>
<span class="pc bpc" id="L482" title="1 of 2 branches missed.">			if (htmlStylesheet != null) {</span>
<span class="nc" id="L483">				this.options.setHtmlStylesheet(Optional.of(htmlStylesheet));</span>
			}
<span class="fc" id="L485">			this.options.setNoAnnotations(parameterParam.getNoAnnotations());</span>
<span class="fc" id="L486">			this.options.setReportOnlyFilename(parameterParam.isReportOnlyFilename());</span>
<span class="fc" id="L487">			this.options.setReportOnlySummary(parameterParam.isReportOnlySummary());</span>
		}
<span class="fc" id="L489">		return this.options;</span>
	}

	boolean breakBuildOnModifications(final ConfigParameters params) {
<span class="fc" id="L493">		return pluginParameters.breakBuild().onModifications()</span>
<span class="fc" id="L494">				| params.getBreakBuildOnModifications();</span>
	}

	boolean breakBuildOnBinaryIncompatibleModifications(final ConfigParameters params) {
<span class="fc" id="L498">		return pluginParameters.breakBuild().onBinaryIncompatibleModifications()</span>
<span class="fc" id="L499">				| params.getBreakBuildOnBinaryIncompatibleModifications();</span>
	}

	boolean breakBuildOnSourceIncompatibleModifications(final ConfigParameters params) {
<span class="fc" id="L503">		return pluginParameters.breakBuild().onSourceIncompatibleModifications()</span>
<span class="fc" id="L504">				| params.getBreakBuildOnSourceIncompatibleModifications();</span>
	}

	boolean breakBuildBasedOnSemanticVersioning(final ConfigParameters params) {
<span class="fc" id="L508">		return pluginParameters.breakBuild().onSemanticVersioning()</span>
<span class="fc" id="L509">				| params.getBreakBuildBasedOnSemanticVersioning();</span>
	}

	boolean breakBuildBasedOnSemanticVersioningForMajorVersionZero(final ConfigParameters params) {
<span class="fc" id="L513">		return pluginParameters.breakBuild().onSemanticVersioningForMajorVersionZero()</span>
<span class="fc" id="L514">				| params.isBreakBuildBasedOnSemanticVersioningForMajorVersionZero();</span>
	}

	File createJApiCmpBaseDir() throws MojoFailureException {
		File baseDir;
		try {
<span class="fc bfc" id="L520" title="All 2 branches covered.">			if (pluginParameters.outputDirectory() != null) {</span>
<span class="fc" id="L521">				baseDir = pluginParameters.outputDirectory();</span>
			} else {
<span class="fc" id="L523">				final File projectBuildDirParam = pluginParameters.projectBuildDir();</span>
<span class="fc" id="L524">				baseDir = new File(</span>
<span class="fc" id="L525">						projectBuildDirParam.getCanonicalPath() + File.separator + &quot;japicmp&quot;);</span>
			}

<span class="fc" id="L528">			boolean madeDir = true;</span>
<span class="pc bpc" id="L529" title="1 of 2 branches missed.">			if (!baseDir.exists()) {</span>
<span class="fc" id="L530">				madeDir = baseDir.mkdirs();</span>
			}

<span class="pc bpc" id="L533" title="3 of 6 branches missed.">			if ((!madeDir || !baseDir.isDirectory()) || !baseDir.canWrite()) {</span>
<span class="nc" id="L534">				throw new IOException(&quot;mkDirs failed&quot;);</span>
			}
<span class="nc" id="L536">		} catch (IOException e) {</span>
<span class="nc" id="L537">			throw new MojoFailureException(&quot;Failed to create output directory: &quot; + e.getMessage(), e);</span>
<span class="fc" id="L538">		}</span>
<span class="fc" id="L539">		return baseDir;</span>
	}

	private void generateDiffOutput(final Options options,
									final List&lt;JApiClass&gt; jApiClasses,
									final File jApiCmpBuildDir,
									final String semanticVersioningInformation)
			throws IOException, MojoFailureException {
<span class="fc" id="L547">		StdoutOutputGenerator stdoutOutputGenerator = new StdoutOutputGenerator(options, jApiClasses);</span>
<span class="fc" id="L548">		String diffOutput = stdoutOutputGenerator.generate();</span>
<span class="fc" id="L549">		diffOutput += &quot;\nSemantic versioning suggestion: &quot; + semanticVersioningInformation;</span>
<span class="fc" id="L550">		File output = new File(</span>
<span class="fc" id="L551">				jApiCmpBuildDir.getCanonicalPath() + File.separator + createFilename() + &quot;.diff&quot;);</span>
<span class="fc" id="L552">		writeToFile(diffOutput, output);</span>
<span class="fc" id="L553">	}</span>

	private void generateMarkdownOutput(final List&lt;JApiClass&gt; jApiClasses, final File jApiCmpBuildDir)
			throws IOException, MojoFailureException {
<span class="pc bpc" id="L557" title="1 of 2 branches missed.">		if (pluginParameters.isWriteToFiles()) {</span>
<span class="fc" id="L558">			MarkdownOptions mdOptions = MarkdownOptions.newDefault(options);</span>
<span class="fc bfc" id="L559" title="All 2 branches covered.">			if (pluginParameters.parameter().getMarkdownTitle() != null) {</span>
<span class="fc" id="L560">				mdOptions.title.report = pluginParameters.parameter().getMarkdownTitle();</span>
			}
<span class="fc" id="L562">			MarkdownOutputGenerator mdOut = new MarkdownOutputGenerator(mdOptions, jApiClasses);</span>
<span class="fc" id="L563">			String markdown = mdOut.generate();</span>
<span class="fc" id="L564">			File output = new File(</span>
<span class="fc" id="L565">					jApiCmpBuildDir.getCanonicalPath() + File.separator + createFilename() + &quot;.md&quot;);</span>
<span class="fc" id="L566">			writeToFile(markdown, output);</span>
		}
<span class="fc" id="L568">	}</span>

	private void generateXmlOutput(final List&lt;JApiClass&gt; jApiClasses,
								   final File jApiCmpBuildDir,
								   final String semanticVersioningInformation)
			throws IOException {
<span class="pc bpc" id="L574" title="1 of 2 branches missed.">		if (pluginParameters.isWriteToFiles()) {</span>
<span class="fc" id="L575">			XmlOutput xmlOutput = createXmlOutput(jApiClasses, jApiCmpBuildDir,</span>
					semanticVersioningInformation);
<span class="fc" id="L577">			List&lt;File&gt; filesWritten = XmlOutputGenerator.writeToFiles(options, xmlOutput);</span>
<span class="fc bfc" id="L578" title="All 2 branches covered.">			for (File file : filesWritten) {</span>
<span class="fc" id="L579">				log.info(&quot;Created file '&quot; + file.getAbsolutePath() + &quot;'.&quot;);</span>
<span class="fc" id="L580">			}</span>
		}
<span class="fc" id="L582">	}</span>

	private XmlOutput createXmlOutput(final List&lt;JApiClass&gt; jApiClasses,
									  final File jApiCmpBuildDir,
									  final String semanticVersioningInformation)
			throws IOException {
<span class="fc" id="L588">		String filename = createFilename();</span>
<span class="fc" id="L589">		options.setXmlOutputFile(</span>
<span class="fc" id="L590">				Optional.of(jApiCmpBuildDir.getCanonicalPath() + File.separator + filename + &quot;.xml&quot;));</span>
<span class="fc" id="L591">		XmlOutputGeneratorOptions xmlOutputGeneratorOptions = new XmlOutputGeneratorOptions();</span>
<span class="fc" id="L592">		xmlOutputGeneratorOptions.setCreateSchemaFile(true);</span>
<span class="fc" id="L593">		xmlOutputGeneratorOptions.setSemanticVersioningInformation(semanticVersioningInformation);</span>

<span class="fc" id="L595">		String optionalTitle = pluginParameters.parameter().getHtmlTitle();</span>
<span class="fc" id="L596">		xmlOutputGeneratorOptions.setTitle(</span>
<span class="fc bfc" id="L597" title="All 2 branches covered.">				optionalTitle != null ? optionalTitle : options.getDifferenceDescription());</span>

<span class="fc" id="L599">		XmlOutputGenerator xmlGenerator = new XmlOutputGenerator(jApiClasses, options,</span>
				xmlOutputGeneratorOptions);
<span class="fc" id="L601">		return xmlGenerator.generate();</span>
	}

	private HtmlOutput generateHtmlOutput(final List&lt;JApiClass&gt; jApiClasses,
										  final File jApiCmpBuildDir,
										  final String semanticVersioningInformation)
			throws IOException {
<span class="fc" id="L608">		HtmlOutput htmlOutput = createHtmlOutput(jApiClasses, jApiCmpBuildDir,</span>
				semanticVersioningInformation);
<span class="pc bpc" id="L610" title="2 of 4 branches missed.">		if (pluginParameters.isWriteToFiles() &amp;&amp; options.getHtmlOutputFile().isPresent()) {</span>
<span class="fc" id="L611">			Path path = Paths.get(options.getHtmlOutputFile().get());</span>
<span class="fc" id="L612">			Files.write(path, htmlOutput.getHtml().getBytes(StandardCharsets.UTF_8));</span>
<span class="fc" id="L613">			log.info(&quot;Written file '&quot; + path + &quot;'.&quot;);</span>
		}
<span class="fc" id="L615">		return htmlOutput;</span>
	}

	private HtmlOutput createHtmlOutput(final List&lt;JApiClass&gt; jApiClasses,
										final File jApiCmpBuildDir,
										final String semanticVersioningInformation)
			throws IOException {
<span class="fc" id="L622">		final String filename = createFilename();</span>
<span class="fc" id="L623">		options.setHtmlOutputFile(</span>
<span class="fc" id="L624">				Optional.of(jApiCmpBuildDir.getCanonicalPath() + File.separator + filename + &quot;.html&quot;));</span>
<span class="fc" id="L625">		HtmlOutputGeneratorOptions htmlOutputGeneratorOptions = new HtmlOutputGeneratorOptions();</span>
<span class="fc" id="L626">		htmlOutputGeneratorOptions.setSemanticVersioningInformation(semanticVersioningInformation);</span>
<span class="fc" id="L627">		final String title = pluginParameters.parameter().getHtmlTitle();</span>
<span class="fc bfc" id="L628" title="All 2 branches covered.">		htmlOutputGeneratorOptions.setTitle(title != null ? title : options.getDifferenceDescription());</span>

<span class="fc" id="L630">		final HtmlOutputGenerator htmlOutputGenerator = new HtmlOutputGenerator(jApiClasses, options,</span>
				htmlOutputGeneratorOptions);
<span class="fc" id="L632">		return htmlOutputGenerator.generate();</span>
	}

	boolean skipModule() {
<span class="fc" id="L636">		SkipModuleStrategy skipModuleStrategy = new SkipModuleStrategy(pluginParameters,</span>
				mavenParameters, log);
<span class="fc" id="L638">		return skipModuleStrategy.skip();</span>
	}

	boolean skipDiffReport() {
<span class="fc" id="L642">		return pluginParameters.skipReport().diffReport() |</span>
<span class="fc" id="L643">				pluginParameters.parameter().skipDiffReport();</span>
	}

	boolean skipHtmlReport() {
<span class="fc" id="L647">		return pluginParameters.skipReport().htmlReport() |</span>
<span class="fc" id="L648">				pluginParameters.parameter().skipHtmlReport();</span>
	}

	boolean skipMarkdownReport() {
<span class="fc" id="L652">		return pluginParameters.skipReport().markdownReport() |</span>
<span class="fc" id="L653">				pluginParameters.parameter().skipMarkdownReport();</span>
	}

	boolean skipXmlReport() {
<span class="fc" id="L657">		return pluginParameters.skipReport().xmlReport() |</span>
<span class="fc" id="L658">				pluginParameters.parameter().skipXmlReport();</span>
	}

	private String createFilename() {
<span class="fc" id="L662">		String filename = &quot;japicmp&quot;;</span>
<span class="fc" id="L663">		String executionId = mavenParameters.mojoExecution().getExecutionId();</span>
<span class="pc bpc" id="L664" title="3 of 4 branches missed.">		if (executionId != null &amp;&amp; !&quot;default&quot;.equals(executionId)) {</span>
<span class="nc" id="L665">			filename = executionId;</span>
		}
<span class="fc" id="L667">		StringBuilder sb = new StringBuilder();</span>
<span class="fc bfc" id="L668" title="All 2 branches covered.">		for (char c : filename.toCharArray()) {</span>
<span class="pc bpc" id="L669" title="4 of 6 branches missed.">			if (c == '.' || Character.isJavaIdentifierPart(c) || c == '-') {</span>
<span class="fc" id="L670">				sb.append(c);</span>
			}
		}
<span class="fc" id="L673">		return sb.toString();</span>
	}

	private void setUpClassPath(final JarArchiveComparatorOptions comparatorOptions)
			throws MojoFailureException {
<span class="pc bpc" id="L678" title="1 of 2 branches missed.">		if (pluginParameters != null) {</span>
<span class="pc bpc" id="L679" title="1 of 2 branches missed.">			if (pluginParameters.dependencies() != null) {</span>
<span class="nc bnc" id="L680" title="All 2 branches missed.">				if (pluginParameters.oldClassPathDependencies() != null</span>
<span class="nc bnc" id="L681" title="All 2 branches missed.">						|| pluginParameters.newClassPathDependencies() != null) {</span>
<span class="nc" id="L682">					throw new MojoFailureException(</span>
							&quot;Please specify either a &lt;dependencies/&gt; element or the two elements &quot;
									+ &quot;&lt;oldClassPathDependencies/&gt; and &lt;newClassPathDependencies/&gt;. &quot;
									+
									&quot;With &lt;dependencies/&gt; you can specify one common classpath for both versions and &quot;
									+ &quot;with &lt;oldClassPathDependencies/&gt; and &lt;newClassPathDependencies/&gt; a &quot;
									+ &quot;separate classpath for the new and old version.&quot;);
				} else {
<span class="nc" id="L690">					log.debug(&quot;Element &lt;dependencies/&gt; found. Using &quot;</span>
							+ JApiCli.ClassPathMode.ONE_COMMON_CLASSPATH);
<span class="nc bnc" id="L692" title="All 2 branches missed.">					for (Dependency dependency : pluginParameters.dependencies()) {</span>
<span class="nc" id="L693">						List&lt;JApiCmpArchive&gt; jApiCmpArchives = resolveDependencyToFile(&quot;dependencies&quot;,</span>
								dependency,
								ConfigurationVersion.NEW);

<span class="nc bnc" id="L697" title="All 2 branches missed.">						for (JApiCmpArchive jApiCmpArchive : jApiCmpArchives) {</span>
<span class="nc" id="L698">							comparatorOptions.getClassPathEntries().add(</span>
<span class="nc" id="L699">									jApiCmpArchive.getFile().getAbsolutePath());</span>
<span class="nc" id="L700">						}</span>
<span class="nc" id="L701">						comparatorOptions.setClassPathMode(</span>
								JarArchiveComparatorOptions.ClassPathMode.ONE_COMMON_CLASSPATH);
<span class="nc" id="L703">					}</span>
				}
			} else {
<span class="pc bpc" id="L706" title="1 of 2 branches missed.">				if (pluginParameters.oldClassPathDependencies() != null</span>
<span class="pc bpc" id="L707" title="1 of 2 branches missed.">						|| pluginParameters.newClassPathDependencies() != null) {</span>
<span class="nc" id="L708">					log.debug(&quot;At least one of the elements &lt;oldClassPathDependencies/&gt; or &quot;</span>
							+ &quot;&lt;newClassPathDependencies/&gt; found. Using &quot;
							+ JApiCli.ClassPathMode.TWO_SEPARATE_CLASSPATHS);
<span class="nc bnc" id="L711" title="All 2 branches missed.">					if (pluginParameters.oldClassPathDependencies() != null) {</span>
<span class="nc bnc" id="L712" title="All 2 branches missed.">						for (Dependency dependency : pluginParameters.oldClassPathDependencies()) {</span>
<span class="nc" id="L713">							List&lt;JApiCmpArchive&gt; jApiCmpArchives = resolveDependencyToFile(</span>
									&quot;oldClassPathDependencies&quot;, dependency, ConfigurationVersion.OLD);
<span class="nc bnc" id="L715" title="All 2 branches missed.">							for (JApiCmpArchive archive : jApiCmpArchives) {</span>
<span class="nc" id="L716">								comparatorOptions.getOldClassPath().add(archive.getFile().getAbsolutePath());</span>
<span class="nc" id="L717">							}</span>
<span class="nc" id="L718">						}</span>
					}
<span class="nc bnc" id="L720" title="All 2 branches missed.">					if (pluginParameters.newClassPathDependencies() != null) {</span>
<span class="nc bnc" id="L721" title="All 2 branches missed.">						for (Dependency dependency : pluginParameters.newClassPathDependencies()) {</span>
<span class="nc" id="L722">							List&lt;JApiCmpArchive&gt; jApiCmpArchives = resolveDependencyToFile(</span>
									&quot;newClassPathDependencies&quot;, dependency, ConfigurationVersion.NEW);
<span class="nc bnc" id="L724" title="All 2 branches missed.">							for (JApiCmpArchive archive : jApiCmpArchives) {</span>
<span class="nc" id="L725">								comparatorOptions.getNewClassPath().add(archive.getFile().getAbsolutePath());</span>
<span class="nc" id="L726">							}</span>
<span class="nc" id="L727">						}</span>
					}
<span class="nc" id="L729">					comparatorOptions.setClassPathMode(</span>
							JarArchiveComparatorOptions.ClassPathMode.TWO_SEPARATE_CLASSPATHS);
				} else {
<span class="fc" id="L732">					log.debug(</span>
							&quot;None of the elements &lt;oldClassPathDependencies/&gt;, &lt;newClassPathDependencies/&gt; or&quot;
									+ &quot; &lt;dependencies/&gt; found. Using &quot;
									+ JApiCli.ClassPathMode.ONE_COMMON_CLASSPATH);

<span class="fc" id="L737">					comparatorOptions.setClassPathMode(</span>
							JarArchiveComparatorOptions.ClassPathMode.ONE_COMMON_CLASSPATH);
				}
			}
		}
<span class="fc" id="L742">		setUpClassPathUsingMavenProject(comparatorOptions);</span>
<span class="fc" id="L743">	}</span>

	private void setUpClassPathUsingMavenProject(final JarArchiveComparatorOptions comparatorOptions)
			throws MojoFailureException {
<span class="fc" id="L747">		MavenProject mavenProject = mavenParameters.mavenProject();</span>
<span class="fc" id="L748">		notNull(mavenProject, &quot;Maven parameter mavenProject should be provided by maven container.&quot;);</span>
<span class="fc" id="L749">		Set&lt;String&gt; classPathEntries = new HashSet&lt;&gt;();</span>
<span class="fc bfc" id="L750" title="All 2 branches covered.">		for (Artifact artifact : getCompileArtifacts(mavenProject)) {</span>
<span class="fc" id="L751">			File resolvedFile = artifact.getFile();</span>
<span class="pc bpc" id="L752" title="1 of 2 branches missed.">			if (resolvedFile != null) {</span>
<span class="nc" id="L753">				String absolutePath = resolvedFile.getAbsolutePath();</span>
<span class="nc bnc" id="L754" title="All 2 branches missed.">				if (classPathEntries.add(absolutePath)) {</span>
<span class="nc" id="L755">					log.debug(&quot;Adding to classpath: &quot; + absolutePath);</span>
				}
<span class="nc" id="L757">			} else {</span>
<span class="fc" id="L758">				handleMissingArtifactFile(artifact);</span>
			}
<span class="fc" id="L760">		}</span>
<span class="fc" id="L761">		comparatorOptions.getClassPathEntries().addAll(classPathEntries);</span>
<span class="fc" id="L762">	}</span>

	private Set&lt;Artifact&gt; getCompileArtifacts(final MavenProject mavenProject) {
<span class="fc" id="L765">		Set&lt;org.apache.maven.artifact.Artifact&gt; projectDependencies =</span>
<span class="fc" id="L766">				mavenProject.getArtifacts(); // dependencies that this project has, including transitive</span>
		// ones
<span class="fc" id="L768">		HashSet&lt;Artifact&gt; result = new HashSet&lt;&gt;(1 + projectDependencies.size());</span>
<span class="fc" id="L769">		result.add(RepositoryUtils.toArtifact(mavenProject.getArtifact())); // distinguished: the</span>
		// project artifact
<span class="pc bpc" id="L771" title="1 of 2 branches missed.">		for (org.apache.maven.artifact.Artifact dep : projectDependencies) {</span>
<span class="nc bnc" id="L772" title="All 2 branches missed.">			if (dep.getArtifactHandler().isAddedToClasspath()) {</span>
<span class="nc bnc" id="L773" title="All 2 branches missed.">				if (org.apache.maven.artifact.Artifact.SCOPE_COMPILE.equals(dep.getScope())</span>
<span class="nc bnc" id="L774" title="All 2 branches missed.">						|| org.apache.maven.artifact.Artifact.SCOPE_PROVIDED.equals(dep.getScope())</span>
<span class="nc bnc" id="L775" title="All 2 branches missed.">						|| org.apache.maven.artifact.Artifact.SCOPE_SYSTEM.equals(dep.getScope())) {</span>
<span class="nc" id="L776">					result.add(RepositoryUtils.toArtifact(dep));</span>
				}
			}
<span class="nc" id="L779">		}</span>
<span class="fc" id="L780">		return result;</span>
	}

	private void handleMissingArtifactFile(final Artifact artifact) {
<span class="pc bpc" id="L784" title="1 of 2 branches missed.">		if (pluginParameters.parameter().isIgnoreMissingOptionalDependency()) {</span>
<span class="nc" id="L785">			log.info(&quot;Ignoring missing optional dependency: &quot; + toDescriptor(artifact));</span>
		} else {
<span class="fc" id="L787">			log.warn(&quot;Could not resolve optional artifact: &quot; + toDescriptor(artifact));</span>
		}
<span class="fc" id="L789">	}</span>

	private String toDescriptor(final Artifact artifact) {
<span class="fc" id="L792">		return artifact.getGroupId() + &quot;:&quot; + artifact.getArtifactId() + &quot;:&quot; + artifact.getVersion();</span>
	}

	private List&lt;JApiCmpArchive&gt; retrieveFileFromConfiguration(
			final DependencyDescriptor dependencyDescriptor,
			final String parameterName,
			final ConfigurationVersion configurationVersion)
			throws MojoFailureException {
		List&lt;JApiCmpArchive&gt; jApiCmpArchives;
<span class="nc bnc" id="L801" title="All 2 branches missed.">		if (dependencyDescriptor instanceof Dependency) {</span>
<span class="nc" id="L802">			Dependency dependency = (Dependency) dependencyDescriptor;</span>
<span class="nc" id="L803">			jApiCmpArchives = resolveDependencyToFile(parameterName, dependency, configurationVersion);</span>
<span class="nc bnc" id="L804" title="All 2 branches missed.">		} else if (dependencyDescriptor instanceof ConfigurationFile) {</span>
<span class="nc" id="L805">			ConfigurationFile configurationFile = (ConfigurationFile) dependencyDescriptor;</span>
<span class="nc" id="L806">			jApiCmpArchives = resolveConfigurationFileToFile(parameterName, configurationFile,</span>
					configurationVersion);
<span class="nc" id="L808">		} else {</span>
<span class="nc" id="L809">			throw new MojoFailureException(</span>
					&quot;DependencyDescriptor is not of type &lt;dependency/&gt; nor of type &lt;configurationFile/&gt;.&quot;);
		}
<span class="nc" id="L812">		return jApiCmpArchives;</span>
	}

	private List&lt;JApiCmpArchive&gt; retrieveFileFromConfiguration(final Version version,
															   final String parameterName,
															   final ConfigurationVersion configurationVersion)
			throws MojoFailureException {
<span class="pc bpc" id="L819" title="1 of 2 branches missed.">		if (version != null) {</span>
<span class="fc" id="L820">			final Dependency dependency = version.getDependency();</span>
<span class="pc bpc" id="L821" title="1 of 2 branches missed.">			if (dependency != null) {</span>
<span class="fc" id="L822">				return resolveDependencyToFile(parameterName, dependency, configurationVersion);</span>
<span class="nc bnc" id="L823" title="All 2 branches missed.">			} else if (version.getFile() != null) {</span>
<span class="nc" id="L824">				final ConfigurationFile configurationFile = version.getFile();</span>
<span class="nc" id="L825">				return resolveConfigurationFileToFile(parameterName, configurationFile,</span>
						configurationVersion);
			} else {
<span class="nc" id="L828">				throw new MojoFailureException(&quot;Missing configuration parameter 'dependency'.&quot;);</span>
			}
		}
<span class="nc" id="L831">		throw new MojoFailureException(</span>
<span class="nc" id="L832">				String.format(&quot;Missing configuration parameter: %s&quot;, parameterName));</span>
	}

	private List&lt;JApiCmpArchive&gt; resolveConfigurationFileToFile(final String parameterName,
																final ConfigurationFile configurationFile,
																final ConfigurationVersion configurationVersion)
			throws MojoFailureException {
<span class="nc" id="L839">		String path = configurationFile.getPath();</span>
<span class="nc bnc" id="L840" title="All 2 branches missed.">		if (path == null) {</span>
<span class="nc" id="L841">			throw new MojoFailureException(</span>
<span class="nc" id="L842">					String.format(</span>
							&quot;The path element in the configuration of the plugin is missing for %s.&quot;,
							parameterName));
		}
<span class="nc" id="L846">		File file = new File(path);</span>
<span class="nc bnc" id="L847" title="All 2 branches missed.">		if (!file.exists()) {</span>
<span class="nc bnc" id="L848" title="All 2 branches missed.">			if (!ignoreMissingArtifact(configurationVersion)) {</span>
<span class="nc" id="L849">				throw new MojoFailureException(</span>
<span class="nc" id="L850">						String.format(&quot;The path '%s' does not point to an existing file.&quot;, path));</span>
			} else {
<span class="nc" id="L852">				log.warn(&quot;The file given by path '&quot; + file.getAbsolutePath() + &quot;' does not exist.&quot;);</span>
			}
		}
<span class="nc bnc" id="L855" title="All 4 branches missed.">		if (!file.isFile() || !file.canRead()) {</span>
<span class="nc bnc" id="L856" title="All 2 branches missed.">			if (!ignoreMissingArtifact(configurationVersion)) {</span>
<span class="nc" id="L857">				throw new MojoFailureException(</span>
<span class="nc" id="L858">						String.format(</span>
								&quot;The file given by path '%s' is either not a file or is not readable.&quot;,
								path));
			} else {
<span class="nc" id="L862">				log.warn(&quot;The file given by path '&quot;</span>
<span class="nc" id="L863">						+ file.getAbsolutePath()</span>
						+ &quot;' is either not a file or is not readable.&quot;);
			}
		}
<span class="nc" id="L867">		return Collections.singletonList(new JApiCmpArchive(file, FileHelper.guessVersion(file)));</span>
	}

	List&lt;JApiCmpArchive&gt; resolveDependencyToFile(final String parameterName,
												 final Dependency dependency,
												 final ConfigurationVersion configurationVersion)
			throws MojoFailureException {
<span class="fc" id="L874">		List&lt;JApiCmpArchive&gt; jApiCmpArchives = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L875">		log.debug(&quot;Trying to resolve dependency '&quot; + dependency + &quot;' to file.&quot;);</span>
<span class="fc" id="L876">		MavenProject mavenProject = mavenParameters.mavenProject();</span>
<span class="pc bpc" id="L877" title="1 of 2 branches missed.">		if (dependency.getSystemPath() == null) {</span>
<span class="fc" id="L878">			String descriptor = dependency.getGroupId()</span>
					+ &quot;:&quot;
<span class="fc" id="L880">					+ dependency.getArtifactId()</span>
					+ &quot;:&quot;
<span class="fc" id="L882">					+ dependency.getVersion();</span>
<span class="fc" id="L883">			log.debug(parameterName + &quot;: &quot; + descriptor);</span>
<span class="fc" id="L884">			String projectDescriptor = mavenProject.getGroupId()</span>
					+ &quot;:&quot;
<span class="fc" id="L886">					+ mavenProject.getArtifactId()</span>
					+ &quot;:&quot;
<span class="fc" id="L888">					+ mavenProject.getVersion();</span>
			Set&lt;Artifact&gt; artifacts;
<span class="pc bpc" id="L890" title="1 of 2 branches missed.">			if (descriptor.equals(projectDescriptor)) {</span>
				// do not repeat what Maven already did for us
<span class="nc" id="L892">				artifacts = getCompileArtifacts(mavenProject);</span>
			} else {
<span class="fc" id="L894">				artifacts = resolveArtifact(dependency, configurationVersion);</span>
			}
<span class="fc bfc" id="L896" title="All 2 branches covered.">			for (Artifact artifact : artifacts) {</span>
<span class="fc" id="L897">				File file = artifact.getFile();</span>
<span class="pc bpc" id="L898" title="1 of 2 branches missed.">				if (file != null) {</span>
<span class="fc" id="L899">					jApiCmpArchives.add(new JApiCmpArchive(file, artifact.getVersion()));</span>
				} else {
<span class="nc" id="L901">					handleMissingArtifactFile(artifact);</span>
				}
<span class="fc" id="L903">			}</span>
<span class="fc bfc" id="L904" title="All 2 branches covered.">			if (jApiCmpArchives.isEmpty()) {</span>
<span class="fc" id="L905">				String message = String.format(&quot;Could not resolve dependency with descriptor '%s'.&quot;,</span>
						descriptor);
<span class="pc bpc" id="L907" title="1 of 2 branches missed.">				if (ignoreMissingArtifact(configurationVersion)) {</span>
<span class="fc" id="L908">					log.warn(message);</span>
				} else {
<span class="nc" id="L910">					throw new MojoFailureException(message);</span>
				}
			}
<span class="fc" id="L913">		} else {</span>
<span class="nc" id="L914">			String systemPath = dependency.getSystemPath();</span>
<span class="nc" id="L915">			Pattern pattern = Pattern.compile(&quot;\\$\\{([^}])&quot;);</span>
<span class="nc" id="L916">			Matcher matcher = pattern.matcher(systemPath);</span>
<span class="nc bnc" id="L917" title="All 2 branches missed.">			if (matcher.matches()) {</span>
<span class="nc bnc" id="L918" title="All 2 branches missed.">				for (int i = 1; i &lt;= matcher.groupCount(); i++) {</span>
<span class="nc" id="L919">					String property = matcher.group(i);</span>
<span class="nc" id="L920">					String propertyResolved = mavenParameters.mavenProject().getProperties().getProperty(</span>
							property);
<span class="nc bnc" id="L922" title="All 2 branches missed.">					if (propertyResolved != null) {</span>
<span class="nc" id="L923">						systemPath = systemPath.replaceAll(&quot;${&quot; + property + &quot;}&quot;, propertyResolved);</span>
					} else {
<span class="nc" id="L925">						throw new MojoFailureException(&quot;Could not resolve property '&quot; + property + &quot;'.&quot;);</span>
					}
				}
			}
<span class="nc" id="L929">			File file = new File(systemPath);</span>
<span class="nc" id="L930">			boolean addFile = true;</span>
<span class="nc bnc" id="L931" title="All 2 branches missed.">			if (!file.exists()) {</span>
<span class="nc bnc" id="L932" title="All 2 branches missed.">				if (ignoreMissingArtifact(configurationVersion)) {</span>
<span class="nc" id="L933">					log.warn(&quot;Could not find file, but ignoreMissingOldVersion is set to true: &quot;</span>
<span class="nc" id="L934">							+ file.getAbsolutePath());</span>
				} else {
<span class="nc" id="L936">					throw new MojoFailureException(&quot;File '&quot; + file.getAbsolutePath() + &quot;' does not exist.&quot;);</span>
				}
<span class="nc" id="L938">				addFile = false;</span>
			}
<span class="nc bnc" id="L940" title="All 2 branches missed.">			if (!file.canRead()) {</span>
<span class="nc bnc" id="L941" title="All 2 branches missed.">				if (ignoreMissingArtifact(configurationVersion)) {</span>
<span class="nc" id="L942">					log.warn(&quot;File is not readable, but ignoreMissingOldVersion is set tot true: &quot;</span>
<span class="nc" id="L943">							+ file.getAbsolutePath());</span>
				} else {
<span class="nc" id="L945">					throw new MojoFailureException(&quot;File '&quot; + file.getAbsolutePath() + &quot;' is not readable.&quot;);</span>
				}
<span class="nc" id="L947">				addFile = false;</span>
			}
<span class="nc" id="L949">			String version = FileHelper.guessVersion(file);</span>
<span class="nc bnc" id="L950" title="All 2 branches missed.">			if (addFile) {</span>
<span class="nc" id="L951">				jApiCmpArchives.add(new JApiCmpArchive(file, version));</span>
			}
		}
<span class="fc" id="L954">		return jApiCmpArchives;</span>
	}

	private boolean ignoreMissingArtifact(final ConfigurationVersion configurationVersion) {
<span class="pc bpc" id="L958" title="1 of 2 branches missed.">		return ignoreNonResolvableArtifacts()</span>
<span class="fc bfc" id="L959" title="All 2 branches covered.">				|| ignoreMissingOldVersion(configurationVersion)</span>
<span class="fc bfc" id="L960" title="All 2 branches covered.">				|| ignoreMissingNewVersion(configurationVersion);</span>
	}

	private boolean ignoreNonResolvableArtifacts() {
<span class="fc" id="L964">		boolean ignoreNonResolvableArtifacts = false;</span>
<span class="fc" id="L965">		ConfigParameters parameterParam = pluginParameters.parameter();</span>
<span class="pc bpc" id="L966" title="1 of 2 branches missed.">		if (parameterParam != null) {</span>
<span class="fc" id="L967">			String ignoreNonResolvableArtifactsAsString =</span>
<span class="fc" id="L968">					parameterParam.getIgnoreNonResolvableArtifacts();</span>
<span class="pc bpc" id="L969" title="1 of 2 branches missed.">			if (Boolean.TRUE.toString().equalsIgnoreCase(ignoreNonResolvableArtifactsAsString)) {</span>
<span class="nc" id="L970">				ignoreNonResolvableArtifacts = true;</span>
			}
		}
<span class="fc" id="L973">		return ignoreNonResolvableArtifacts;</span>
	}

	private boolean ignoreMissingOldVersion(final ConfigurationVersion configurationVersion) {
<span class="fc bfc" id="L977" title="All 2 branches covered.">		return (configurationVersion == ConfigurationVersion.OLD &amp;&amp;</span>
<span class="fc bfc" id="L978" title="All 2 branches covered.">				pluginParameters.parameter().getIgnoreMissingOldVersion());</span>
	}

	private boolean ignoreMissingNewVersion(final ConfigurationVersion configurationVersion) {
<span class="fc bfc" id="L982" title="All 2 branches covered.">		return (configurationVersion == ConfigurationVersion.NEW &amp;&amp;</span>
<span class="fc bfc" id="L983" title="All 2 branches covered.">				pluginParameters.parameter().getIgnoreMissingNewVersion());</span>
	}

	private void writeToFile(final String output, final File outputFile) throws MojoFailureException {
<span class="fc" id="L987">		try (OutputStreamWriter fileWriter = new OutputStreamWriter(</span>
<span class="fc" id="L988">				Files.newOutputStream(outputFile.toPath()), StandardCharsets.UTF_8)) {</span>
<span class="fc" id="L989">			fileWriter.write(output);</span>
<span class="fc" id="L990">			log.info(&quot;Written file '&quot; + outputFile.getAbsolutePath() + &quot;'.&quot;);</span>
<span class="nc" id="L991">		} catch (IOException e) {</span>
<span class="nc" id="L992">			throw new MojoFailureException(String.format(&quot;Failed to write file: %s&quot;, e.getMessage()), e);</span>
<span class="fc" id="L993">		}</span>
<span class="fc" id="L994">	}</span>

	private Set&lt;Artifact&gt; resolveArtifact(final Dependency dependency,
										  final ConfigurationVersion configurationVersion)
			throws MojoFailureException {
<span class="fc" id="L999">		notNull(mavenParameters.artifactRepositories(),</span>
				&quot;Maven parameter artifactRepositories should be provided by maven container.&quot;);
<span class="fc" id="L1001">		Artifact artifact = createDefaultArtifact(dependency.getGroupId(), dependency.getArtifactId(),</span>
<span class="fc" id="L1002">				dependency.getClassifier(), dependency.getType(),</span>
<span class="fc" id="L1003">				dependency.getVersion());</span>
<span class="fc" id="L1004">		return resolveArtifact(artifact, configurationVersion);</span>
	}

	private Set&lt;Artifact&gt; resolveArtifact(final Artifact artifact,
										  final ConfigurationVersion configurationVersion)
			throws MojoFailureException {
<span class="fc" id="L1010">		notNull(mavenParameters.repoSystem(),</span>
				&quot;Maven parameter repoSystem should be provided by maven container.&quot;);
<span class="fc" id="L1012">		notNull(mavenParameters.repoSession(),</span>
				&quot;Maven parameter repoSession should be provided by maven container.&quot;);
<span class="fc" id="L1014">		ArtifactRequest request = new ArtifactRequest();</span>
<span class="fc" id="L1015">		request.setArtifact(artifact);</span>
<span class="fc" id="L1016">		request.setRepositories(mavenParameters.remoteRepos());</span>
		ArtifactResult resolutionResult;
		try {
<span class="fc" id="L1019">			log.debug(&quot;Trying to resolve artifact: &quot; + request);</span>
<span class="fc" id="L1020">			resolutionResult = mavenParameters.repoSystem().resolveArtifact(mavenParameters.repoSession(),</span>
					request);
<span class="fc" id="L1022">			log.debug(&quot;Resolved artifact: &quot; + resolutionResult);</span>
<span class="pc bpc" id="L1023" title="1 of 2 branches missed.">			if (resolutionResult != null) {</span>
<span class="pc bpc" id="L1024" title="1 of 2 branches missed.">				if (resolutionResult.getExceptions() != null &amp;&amp; !resolutionResult.getExceptions()</span>
<span class="pc bpc" id="L1025" title="1 of 2 branches missed.">						.isEmpty()) {</span>
<span class="nc" id="L1026">					List&lt;Exception&gt; exceptions = resolutionResult.getExceptions();</span>
<span class="nc bnc" id="L1027" title="All 2 branches missed.">					for (Exception exception : exceptions) {</span>
<span class="nc" id="L1028">						log.debug(exception.getMessage(), exception);</span>
<span class="nc" id="L1029">					}</span>
				}
<span class="pc bpc" id="L1031" title="1 of 2 branches missed.">				if (resolutionResult.isMissing()) {</span>
<span class="nc bnc" id="L1032" title="All 2 branches missed.">					if (ignoreMissingArtifact(configurationVersion)) {</span>
<span class="nc" id="L1033">						log.warn(&quot;Ignoring missing artifact &quot; + request.getArtifact());</span>
					} else {
<span class="nc" id="L1035">						throw new MojoFailureException(&quot;Could not resolve artifact &quot; + request.getArtifact());</span>
					}
<span class="nc" id="L1037">					return new HashSet&lt;&gt;();</span>
				}
<span class="fc" id="L1039">				return new HashSet&lt;&gt;(Collections.singletonList(resolutionResult.getArtifact()));</span>
			}
<span class="fc" id="L1041">		} catch (final ArtifactResolutionException e) {</span>
<span class="fc bfc" id="L1042" title="All 2 branches covered.">			if (ignoreMissingArtifact(configurationVersion)) {</span>
<span class="fc" id="L1043">				log.warn(e.getMessage());</span>
			} else {
<span class="fc" id="L1045">				throw new MojoFailureException(e.getMessage(), e);</span>
			}
<span class="nc" id="L1047">		}</span>
<span class="fc" id="L1048">		return new HashSet&lt;&gt;();</span>
	}

	private &lt;T&gt; void notNull(final T value, final String msg) throws MojoFailureException {
<span class="pc bpc" id="L1052" title="1 of 2 branches missed.">		if (value == null) {</span>
<span class="nc" id="L1053">			throw new MojoFailureException(msg);</span>
		}
<span class="fc" id="L1055">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>